<% content_for :title, "Dashboard" %>

<div class="row">
  <div class="col-12">
    <h1 class="mb-4">
      <i class="bi bi-speedometer2"></i> Dashboard
      <small class="text-muted">Welcome back, <%= current_user.name %></small>
    </h1>
  </div>
</div>

<!-- Statistics Cards -->
<div class="row mb-4">
  <div class="col-md-3">
    <div class="card bg-primary text-white">
      <div class="card-body">
        <div class="d-flex justify-content-between">
          <div>
            <h4><%= @stats[:total_documents] %></h4>
            <p class="mb-0">My Documents</p>
          </div>
          <div class="align-self-center">
            <i class="bi bi-file-text fs-1"></i>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <div class="col-md-3">
    <div class="card bg-success text-white">
      <div class="card-body">
        <div class="d-flex justify-content-between">
          <div>
            <h4><%= @stats[:total_teams] %></h4>
            <p class="mb-0">My Teams</p>
          </div>
          <div class="align-self-center">
            <i class="bi bi-people fs-1"></i>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <div class="col-md-3">
    <div class="card bg-info text-white">
      <div class="card-body">
        <div class="d-flex justify-content-between">
          <div>
            <h4><%= @stats[:led_teams] %></h4>
            <p class="mb-0">Teams I Lead</p>
          </div>
          <div class="align-self-center">
            <i class="bi bi-person-badge fs-1"></i>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <div class="col-md-3">
    <div class="card bg-warning text-white">
      <div class="card-body">
        <div class="d-flex justify-content-between">
          <div>
            <h4><%= @stats[:pending_documents] %></h4>
            <p class="mb-0">Pending Documents</p>
          </div>
          <div class="align-self-center">
            <i class="bi bi-clock fs-1"></i>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="row">
  <!-- Recent Documents -->
  <div class="col-md-6">
    <div class="card">
      <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="mb-0"><i class="bi bi-file-text"></i> Recent Documents</h5>
        <%= link_to "View All", documents_path, class: "btn btn-sm btn-outline-primary" %>
      </div>
      <div class="card-body">
        <% if @recent_documents.any? %>
          <% @recent_documents.each do |document| %>
            <div class="d-flex justify-content-between align-items-center border-bottom py-2">
              <div>
                <h6 class="mb-1">
                  <%= link_to document.title, document, class: "text-decoration-none" %>
                </h6>
                <small class="text-muted">
                  <i class="bi bi-folder"></i> <%= document.folder.name %>
                  <span class="badge" style="background-color: <%= document.status.color %>">
                    <%= document.status.name %>
                  </span>
                </small>
              </div>
              <small class="text-muted">
                <%= time_ago_in_words(document.created_at) %> ago
              </small>
            </div>
          <% end %>
        <% else %>
          <p class="text-muted text-center py-3">No documents yet.</p>
        <% end %>
      </div>
    </div>
  </div>
  
  <!-- Recent Activity -->
  <div class="col-md-6">
    <div class="card">
      <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="mb-0"><i class="bi bi-activity"></i> Recent Activity</h5>
        <%= link_to "View All", activity_logs_path, class: "btn btn-sm btn-outline-primary" %>
      </div>
      <div class="card-body">
        <% if @recent_activity.any? %>
          <% @recent_activity.each do |activity| %>
            <div class="d-flex align-items-start border-bottom py-2">
              <div class="me-3">
                <i class="bi bi-circle-fill text-primary" style="font-size: 0.5rem;"></i>
              </div>
              <div class="flex-grow-1">
                <p class="mb-1">
                  <strong><%= activity.user.name %></strong>
                  <%= activity.action_description %>
                  <strong><%= link_to activity.document.title, activity.document, class: "text-decoration-none" %></strong>
                </p>
                <small class="text-muted">
                  <%= time_ago_in_words(activity.created_at) %> ago
                </small>
              </div>
            </div>
          <% end %>
        <% else %>
          <p class="text-muted text-center py-3">No recent activity</p>
        <% end %>
      </div>
    </div>
  </div>
</div>
