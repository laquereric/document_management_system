<% content_for :title, "Manage Users" %>

<%= render(Layout::Page::PageContent.new(padding: :none)) do %>
  <!-- Page Header -->
  <%= render(Layout::Page::PageHeader.new(
    title: "Manage Users",
    description: "Admin user management and role control",
    icon: "people",
    action: {
      text: "New User",
      url: new_admin_user_path
    }
  )) %>

  <!-- Search and Filters -->
  <%= render(Layout::CardList::SearchFilterSort::SearchAndFiltersComponent.new(
    search_object: @q,
    url: admin_users_path,
    title: "Search & Filters",
    fields: [
      {
        name: :name_cont,
        label: "Name",
        placeholder: "Search by name..."
      },
      {
        name: :email_cont,
        label: "Email",
        placeholder: "Search by email..."
      },
      {
        name: :role_eq,
        label: "Role",
        type: :select,
        options: [['All Roles', ''], ['Admin', 'admin'], ['Team Leader', 'team_leader'], ['Member', 'member']]
      }
    ]
  )) %>

  <!-- Users Grid -->
  <%= render(Layout::CardList.new(
    cards: @users,
    layout: :grid,
    title: "Users",
    empty_state_title: "No users found",
    empty_state_description: params[:q].present? ? "No users match your search criteria. Try adjusting your filters." : "Get started by creating your first user.",
    empty_state_action: {
      text: "Create User",
      url: new_admin_user_path
    }
  )) do %>
    <% @users.each do |user| %>
      <div class="flex-1" style="min-width: 320px; max-width: 400px;">
        <div class="mb-4 mb-lg-0">
          <%= render Models::Users::CardComponent.new(
            user: user, 
            show_admin_actions: true, 
            context: :admin
          ) %>
        </div>
      </div>
    <% end %>
  <% end %>
<% end %>
