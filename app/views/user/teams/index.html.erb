<% content_for :title, "#{@user.name}'s Teams" %>

<%= render(Layout::PageContent.new(padding: :none)) do %>
  <!-- Page Header -->
  <%= render(Layout::PageHeader.new(
    title: "#{@user.name}'s Teams",
    description: "Teams that #{@user.name} is a member of",
    icon: "people"
  )) %>

  <!-- Statistics Cards -->
  <%= render(Layout::StatisticsGrid.new(
    title: "Team Overview",
    statistics: [
      {
        title: "Total Teams",
        value: @teams.respond_to?(:total_count) ? @teams.total_count : @teams.count,
        icon: "people",
        color: "accent"
      },
      {
        title: "Teams Led",
        value: @user.led_teams.count,
        icon: "person-badge",
        color: "success"
      },
      {
        title: "Organizations",
        value: @user.teams.joins(:organization).distinct.count('organizations.id'),
        icon: "organization",
        color: "attention"
      },
      {
        title: "Active This Week",
        value: @user.teams.where('teams.updated_at >= ?', 1.week.ago).count,
        icon: "calendar",
        color: "done"
      }
    ]
  )) %>

  <!-- Teams Section -->
  <%= render(Layout::ContentSection.new(
    title: "My Teams",
    count: @teams.respond_to?(:total_count) ? @teams.total_count : @teams.count
  )) do %>
    <% if @teams.any? %>
      <div class="d-flex flex-wrap gap-3">
        <% @teams.each do |team| %>
          <div class="flex-auto" style="min-width: 300px; max-width: 400px;">
            <%= render(Teams::TeamCardComponent.new(
              team: team,
              current_user: current_user,
              show_actions: false
            )) %>
          </div>
        <% end %>
      </div>

      <!-- Pagination -->
      <% if @teams.respond_to?(:current_page) %>
        <%= render(Layout::CardListPagination.new(collection: @teams)) %>
      <% end %>
    <% else %>
      <%= render(Ui::EmptyStateComponent.new(
        title: "No Teams Found",
        description: "#{@user.name} is not a member of any teams yet.",
        icon: "people"
      )) %>
    <% end %>
  <% end %>
<% end %>
